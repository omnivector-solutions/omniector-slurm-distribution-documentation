
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Partitions &#8212; Omnivector Slurm Distribution 0.0.1 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Infiniband" href="infiniband.html" />
    <link rel="prev" title="Nodes operations" href="nodes.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="partitions">
<span id="id1"></span><h1>Partitions<a class="headerlink" href="#partitions" title="Permalink to this headline">¶</a></h1>
<p>We recommend to use one <code class="docutils literal notranslate"><span class="pre">slurmd</span></code> application for each partition in your
cluster. So, to add a new partition you need to deploy a new <code class="docutils literal notranslate"><span class="pre">slurmd</span></code> charm,
with a new <em>Juju application name</em>.</p>
<div class="section" id="adding-partitions">
<h2>Adding partitions<a class="headerlink" href="#adding-partitions" title="Permalink to this headline">¶</a></h2>
<p>The easiest way to add a new partition is to modify the
<code class="docutils literal notranslate"><span class="pre">slurm-bundles/slurm-core/bundle.yaml</span></code> file with your new application.</p>
<p>To add a <code class="docutils literal notranslate"><span class="pre">slurmd-debug</span></code> application for the <code class="docutils literal notranslate"><span class="pre">debug</span></code> partition, we need to:</p>
<ul class="simple">
<li>add the application;</li>
<li>add a relation to the slurmctld charm;</li>
<li>add extra options depending on the cloud provider.</li>
</ul>
<p>So, edit the bundle file to add a new entry in the <code class="docutils literal notranslate"><span class="pre">applications</span></code> section:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">applications</span><span class="p">:</span>
  <span class="n">slurmd</span><span class="p">:</span>
    <span class="n">charm</span><span class="p">:</span> <span class="o">./../../</span><span class="n">slurm</span><span class="o">-</span><span class="n">charms</span><span class="o">/</span><span class="n">slurmd</span><span class="o">.</span><span class="n">charm</span>
    <span class="n">num_units</span><span class="p">:</span> <span class="mi">1</span>
  <span class="n">slurmd</span><span class="o">-</span><span class="n">debug</span><span class="p">:</span>
    <span class="n">charm</span><span class="p">:</span> <span class="o">./../../</span><span class="n">slurm</span><span class="o">-</span><span class="n">charms</span><span class="o">/</span><span class="n">slurmd</span><span class="o">.</span><span class="n">charm</span>
    <span class="n">num_units</span><span class="p">:</span> <span class="mi">1</span>
  <span class="o">...</span>
</pre></div>
</div>
<p>And similarly, the relations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">relations</span><span class="p">:</span>
  <span class="o">-</span> <span class="o">-</span> <span class="n">slurmctld</span><span class="p">:</span><span class="n">slurmd</span>
    <span class="o">-</span> <span class="n">slurmd</span><span class="o">-</span><span class="n">debug</span><span class="p">:</span><span class="n">slurmd</span>
</pre></div>
</div>
<p>If you need any custom configurations for your cloud provider, you could add
them in this file or in the used overlay file. For example, we provide
constraints and bindings for AWS clouds as an overlay in
<code class="docutils literal notranslate"><span class="pre">slurm-bundles/slurm-core/clouds/aws.yaml</span></code>. If deploying to AWS, you should
also copy those bindings to the new application.</p>
</div>
<div class="section" id="changing-partition-name">
<h2>Changing partition name<a class="headerlink" href="#changing-partition-name" title="Permalink to this headline">¶</a></h2>
<p>By default, the charms create a randomly unique name for each partition. You
can change the partition name with a juju configuration command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ juju config slurmd-debug partition-name<span class="o">=</span>debug
</pre></div>
</div>
<p>Alternatively, you can set the partition name in the bundle file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">slurmd</span><span class="o">-</span><span class="n">debug</span><span class="p">:</span>
  <span class="n">charm</span><span class="p">:</span> <span class="o">./../../</span><span class="n">slurm</span><span class="o">-</span><span class="n">charms</span><span class="o">/</span><span class="n">slurmd</span><span class="o">.</span><span class="n">charm</span>
  <span class="n">num_units</span><span class="p">:</span> <span class="mi">1</span>
  <span class="n">options</span><span class="p">:</span>
    <span class="n">partition</span><span class="o">-</span><span class="n">name</span><span class="p">:</span> <span class="n">debug</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-the-default-partition">
<h2>Setting the default partition<a class="headerlink" href="#setting-the-default-partition" title="Permalink to this headline">¶</a></h2>
<p>To set the default partition, you must configure <code class="docutils literal notranslate"><span class="pre">slurmctld</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ juju config slurmdctld default-partition<span class="o">=</span>debug
</pre></div>
</div>
<p>Alternatively, you can set the partition name in the bundle file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">slurmdctld</span><span class="p">:</span>
  <span class="n">charm</span><span class="p">:</span> <span class="o">./../../</span><span class="n">slurm</span><span class="o">-</span><span class="n">charms</span><span class="o">/</span><span class="n">slurmctld</span><span class="o">.</span><span class="n">charm</span>
  <span class="n">num_units</span><span class="p">:</span> <span class="mi">1</span>
  <span class="n">options</span><span class="p">:</span>
    <span class="n">default</span><span class="o">-</span><span class="n">partition</span><span class="p">:</span> <span class="n">debug</span>
</pre></div>
</div>
</div>
<div class="section" id="changing-partition-state">
<h2>Changing partition state<a class="headerlink" href="#changing-partition-state" title="Permalink to this headline">¶</a></h2>
<p>To change the partition state to one of <code class="docutils literal notranslate"><span class="pre">UP</span></code>, <code class="docutils literal notranslate"><span class="pre">DOWN</span></code>, <code class="docutils literal notranslate"><span class="pre">DRAIN</span></code>, or
<code class="docutils literal notranslate"><span class="pre">INACTIVE</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ juju config slurmd-debug partition-state<span class="o">=</span>DRAIN
</pre></div>
</div>
<p>By default, the partition is in the <code class="docutils literal notranslate"><span class="pre">UP</span></code> state.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Omnivector Slurm Distribution</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">OSD Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="overview.html">Operations Overview</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="nodes.html">Nodes operations</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Partitions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adding-partitions">Adding partitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#changing-partition-name">Changing partition name</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-the-default-partition">Setting the default partition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#changing-partition-state">Changing partition state</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="infiniband.html">Infiniband</a></li>
<li class="toctree-l2"><a class="reference internal" href="nhc.html">NHC</a></li>
<li class="toctree-l2"><a class="reference internal" href="backup-restore.html">Backup and restore the slurm database</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading-osd.html">Upgrade OSD</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/configuration.html">Configuration and Administration</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="overview.html">Operations</a><ul>
      <li>Previous: <a href="nodes.html" title="previous chapter">Nodes operations</a></li>
      <li>Next: <a href="infiniband.html" title="next chapter">Infiniband</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Omnivector Solutions.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/operations/partitions.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>