

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Contributing to OSD &#8212; Omnivector Slurm Distribution  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'contributing';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Acknowledgments" href="acknowledgments.html" />
    <link rel="prev" title="slurmrestd" href="configuration/slurmrestd.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="architecture.html">OSD Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="operations/overview.html">Operations Overview</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="operations/installation.html">Slurm Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="operations/nodes.html">Nodes operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="operations/partitions.html">Partitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="operations/munge.html">Munge operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="operations/infiniband.html">Infiniband</a></li>
<li class="toctree-l2"><a class="reference internal" href="operations/nhc.html">NHC</a></li>
<li class="toctree-l2"><a class="reference internal" href="operations/backup-restore.html">Backup and restore the Slurm database</a></li>
<li class="toctree-l2"><a class="reference internal" href="operations/upgrading-osd.html">Upgrade OSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="operations/accounting-profiling.html">Accounting And Profiling</a></li>
<li class="toctree-l2"><a class="reference internal" href="operations/monitoring.html">Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="operations/logging.html">Logging</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="configuration/configuration.html">Configuration and Administration</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="configuration/slurmd.html">slurmd</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration/slurmdbd.html">slurmdbd</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration/slurmctld.html">slurmctld</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration/slurmrestd.html">slurmrestd</a></li>
</ul>
</li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Contributing to OSD</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgments.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/omnivector-solutions/osd-documentation" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/omnivector-solutions/osd-documentation/issues/new?title=Issue%20on%20page%20%2Fcontributing.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/contributing.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Contributing to OSD</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#feedback">Feedback</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#documentation">Documentation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#git-branches">Git branches</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general-recommendations">General Recommendations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sections">Sections</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#naming-conventions">Naming conventions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#code">Code</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#git-usage">Git usage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#charm-development">Charm development</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#local-setup">Local setup</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#slurm-ops-manager">Slurm-ops-manager</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Slurm-charms</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#actions-and-configurations">Actions and Configurations</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#changelog">CHANGELOG</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#bats-tests">Bats tests</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#versioning">Versioning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#release-process">Release process</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Slurm-ops-manager</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="contributing-to-osd">
<span id="contributing"></span><h1>Contributing to OSD<a class="headerlink" href="#contributing-to-osd" title="Permalink to this heading">#</a></h1>
<p>OSD is an open-source project, and as such we welcome contributions from
developers, engineers, system administrators, and users in general.
Contributions are what make the open source community such an amazing place to
learn, inspire, and create. Any contributions you make are <strong>greatly
appreciated</strong>.</p>
<p>There are many ways to contribute:</p>
<section id="feedback">
<h2>Feedback<a class="headerlink" href="#feedback" title="Permalink to this heading">#</a></h2>
<p>Feedback is very welcome! We are interested in hearing from you how! Email us
&#64; <a class="reference external" href="mailto:info&#37;&#52;&#48;omnivector&#46;solutions">info<span>&#64;</span>omnivector<span>&#46;</span>solutions</a>.</p>
<p>In the case things aren't working as expected, please
<a class="reference external" href="https://github.com/omnivector-solutions/slurm-charms/issues">file a bug</a>.</p>
<p>Reach out if you have any questions and/or suggestions.</p>
</section>
<section id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Permalink to this heading">#</a></h2>
<p>This documentation is built using <a class="reference external" href="https://sphinx-doc.org/">Sphinx</a> and
<a class="reference external" href="https://www.sphinx-doc.org/en/master/usage/restructuredtext/basics.html">reStructuredText</a>,
and is hosted in
<a class="reference external" href="https://github.com/omnivector-solutions/osd-documentation">GitHub</a>.</p>
<section id="git-branches">
<h3>Git branches<a class="headerlink" href="#git-branches" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">master</span></code> branch is rebuilt at every commit and published automatically
<a class="reference external" href="https://omnivector-solutions.github.io/osd-documentation/master/">online</a>.
If you want to test/show any specific branch, you can do so by &quot;resetting&quot; the
<code class="docutils literal notranslate"><span class="pre">testing</span></code> branch. This branch is automatically built and published to
<a class="reference external" href="https://omnivector-solutions.github.io/osd-documentation/testing/">omnivector-solutions.github.io/osd-documentation/testing/</a>.
One way to achieve that is:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>testing
$<span class="w"> </span>git<span class="w"> </span>reset<span class="w"> </span>--hard<span class="w"> </span>&lt;my-branch&gt;
$<span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span>--force
</pre></div>
</div>
</section>
<section id="general-recommendations">
<h3>General Recommendations<a class="headerlink" href="#general-recommendations" title="Permalink to this heading">#</a></h3>
<p>Use US English for writing documentation and always run a spell checker. The
GitHub project will spell check the project on every Pull Request. In case the
spell checker gives an error due to a word not available in the US dictionary,
add this word to the <code class="docutils literal notranslate"><span class="pre">new_words_spell_checker.txt</span></code>. Please keep this file in
alphabetical order.</p>
<p>Wrap the lines at 80 columns when writing documentation.</p>
</section>
<section id="sections">
<h3>Sections<a class="headerlink" href="#sections" title="Permalink to this heading">#</a></h3>
<p>This projects uses the following convention for section headers, from the
<a class="reference external" href="https://www.sphinx-doc.org/en/master/usage/restructuredtext/basics.html#sections">rsTructuredText Primer</a>
document:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">=================</span>
<span class="n">This</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">heading</span>
<span class="o">=================</span>

<span class="n">This</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">section</span>
<span class="o">=================</span>

<span class="n">This</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">subsection</span>
<span class="o">--------------------</span>

<span class="n">This</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">subsubsection</span>
<span class="o">^^^^^^^^^^^^^^^^^^^^^^^</span>

<span class="n">This</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">subsubsubsection</span>
<span class="o">~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
</pre></div>
</div>
</section>
<section id="naming-conventions">
<h3>Naming conventions<a class="headerlink" href="#naming-conventions" title="Permalink to this heading">#</a></h3>
<p>Throughout the documentation and code (specially in logs), we stick to these
naming conventions with regards to Slurm:</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">Slurm</span></code></dt><dd><p>SchedMD Slurm project.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">slurmXXXd</span></code></dt><dd><p>The daemons for the Slurm component.</p>
<p>For example, <code class="docutils literal notranslate"><span class="pre">slurmd</span></code> refers to the daemon for the compute nodes, while
<code class="docutils literal notranslate"><span class="pre">slurmctld</span></code> refers to the daemon for the controller node.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Slurm-charms</span></code></dt><dd><p>Omnivector charms.</p>
</dd>
</dl>
</section>
</section>
<section id="code">
<h2>Code<a class="headerlink" href="#code" title="Permalink to this heading">#</a></h2>
<p>OSD source-code is hosted in GitHub repositories. All the charms are in
<a class="reference external" href="https://github.com/omnivector-solutions/slurm-charms">omnivector-solutions/slurm-charms</a>,
and a common code shared among them, called <code class="docutils literal notranslate"><span class="pre">slurm-ops-mananger</span></code>, is hosted at
<a class="reference external" href="https://github.com/omnivector-solutions/slurm-ops-manager">omnivector-solutions/slurm-ops-manager</a>.</p>
<p>The Slurm-charms source code is developed under the <code class="docutils literal notranslate"><span class="pre">MIT</span></code> license. By
contributing to the Slurm-charms project or affiliated code you are implicitly
agreeing to your code contributions being governed by this license too.</p>
<section id="git-usage">
<h3>Git usage<a class="headerlink" href="#git-usage" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>all commits should be atomic</p></li>
<li><p>all commits should have a proper commit message:</p>
<ul>
<li><p>the first line should be a brief summary of the changes, no longer than 52
characters</p></li>
<li><p>second line should be empty</p></li>
<li><p>subsequent lines should describe the changes and explain why they are
needed</p></li>
<li><p>See <a class="reference external" href="https://cbea.ms/git-commit/">How to Write a Git Commit Message</a> for
a detailed guide on this subject</p></li>
</ul>
</li>
<li><p>linear history</p>
<ul>
<li><p>always rebase your branch with master</p></li>
<li><p>When merging the Pull Requests, use fast forward merge or squash merge.</p></li>
</ul>
</li>
<li><p>keep user related changes in the <a class="reference internal" href="#changelog"><span class="std std-ref">CHANGELOG</span></a></p></li>
<li><p>create annotated tags for releases, see <a class="reference internal" href="#release-process"><span class="std std-ref">Release process</span></a> below for
details</p></li>
<li><p>use meaningful names for branches</p></li>
<li><p>do not include merge commits in new branches. New branches should contain
only new code.</p></li>
</ul>
</section>
<section id="charm-development">
<span id="id1"></span><h3>Charm development<a class="headerlink" href="#charm-development" title="Permalink to this heading">#</a></h3>
<p>All Python code should be compliant with Python3.6. This is a strong
requirement for the charms to run on CentOS7.</p>
<p>The coding style used follows closely
<a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">PEP-008</a>.</p>
<section id="local-setup">
<h4>Local setup<a class="headerlink" href="#local-setup" title="Permalink to this heading">#</a></h4>
<p>This sections describes how to setup your system for local charm development.
This section assumes the system is Linux-based and has support for <cite>snaps</cite>.</p>
<p>The tool used to build a charm is
<a class="reference external" href="https://github.com/canonical/charmcraft/">charmcraft</a>, and it should be
installed as a classical snap:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>sudo<span class="w"> </span>snap<span class="w"> </span>install<span class="w"> </span>charmcraft<span class="w"> </span>--classic
</pre></div>
</div>
<p>The OSD charm code is available in the Git repository <a class="reference external" href="https://github.com/omnivector-solutions/slurm-charms">slurm-charms</a>, it contains all the
nuts and bolts of all Slurm-charms as well as a helper <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> to build
them. To clone and build:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/omnivector-solutions/slurm-charms
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>slurm-charms
$<span class="w"> </span>make<span class="w"> </span>charms
</pre></div>
</div>
<p>After the <code class="docutils literal notranslate"><span class="pre">.charm</span></code> artifacts have been produced, <code class="docutils literal notranslate"><span class="pre">juju</span></code> can be used to
deploy the built charms to a cloud environment of your choosing. There are two
primary ways to deploy the charms after building them:</p>
<ul>
<li><p>use Juju to deploy the built charms directly e.g.
<code class="docutils literal notranslate"><span class="pre">juju</span> <span class="pre">deploy</span> <span class="pre">./slurmd.charm</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">slurmctld</span></code> requires an <code class="docutils literal notranslate"><span class="pre">etcd</span></code> resource to be deployed. Download it
from <a class="reference external" href="https://github.com/etcd-io/etcd/releases/">etcd releases</a> and
specify it in the deploy command, e.g. <code class="docutils literal notranslate"><span class="pre">juju</span> <span class="pre">deploy</span> <span class="pre">./slurmctld</span>
<span class="pre">--resource</span> <span class="pre">etcd=etcd-v3.5.0-linux-amd64.tar.gz</span></code>. This is not necessary
if using the <code class="docutils literal notranslate"><span class="pre">slurm-bundles</span></code> Makefile.</p>
</div>
</li>
<li><p>deploy the local development bundle contained in <a class="reference external" href="https://github.com/omnivector-solutions/slurm-bundles">slurm-bundles</a>. The
<code class="docutils literal notranslate"><span class="pre">slurm-bundles</span></code> contain a helper Makefile that provide a way to easily
deploy the built charms to a local LXD cloud by using the command <code class="docutils literal notranslate"><span class="pre">make</span>
<span class="pre">lxd-focal</span></code>, or for CentOS7, <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">lxd-centos</span></code>. See <a class="reference internal" href="installation.html#installation"><span class="std std-ref">Installation overview</span></a> for
more details</p></li>
</ul>
</section>
<section id="slurm-ops-manager">
<h4>Slurm-ops-manager<a class="headerlink" href="#slurm-ops-manager" title="Permalink to this heading">#</a></h4>
<p>The <a class="reference external" href="https://github.com/omnivector-solutions/slurm-bundles">slurm-ops-manager</a> is a code base that
contains common methods and attributes used across multiple Slurm charms. Code
that is used in more than one Slurm charm should not be repeated, it should
live in this project instead.</p>
<p>After making a new <code class="docutils literal notranslate"><span class="pre">slurm-ops-manager</span></code> release, the Slurm-charms project
should have one new commit in which the <code class="docutils literal notranslate"><span class="pre">slurm-ops-manager</span></code> version is
incremented:</p>
<ul class="simple">
<li><p>update the version of <code class="docutils literal notranslate"><span class="pre">slurm-ops-manager</span></code> in the <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file
for each charm</p></li>
<li><p>update the <a class="reference internal" href="#changelog"><span class="std std-ref">CHANGELOG</span></a>.</p></li>
<li><p>this should be a single commit. If there are any necessary changes in the
charms, these should live in separate commits.</p></li>
</ul>
</section>
<section id="id3">
<h4>Slurm-charms<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h4>
<p>Find below the standards and conventions used when contributing code to the
<a class="reference external" href="https://github.com/omnivector-solutions/slurm-charms">slurm-charms</a>.</p>
<section id="actions-and-configurations">
<h5>Actions and Configurations<a class="headerlink" href="#actions-and-configurations" title="Permalink to this heading">#</a></h5>
<p>In an effort to keep the OSD documentation current and accurate, we generate
the documentation for charm actions and charm configurations dynamically. OSD
documentation is built in such a way that the actions and configurations that
exist in each Slurm charm are what end up in the documentation.</p>
<p>All actions, configurations, and their parameters <em>should</em> have a
description. A few things to note around the description field:</p>
<ul class="simple">
<li><p>inline markdown code is translated to inline reStructuredText code</p></li>
<li><p>if there is a <code class="docutils literal notranslate"><span class="pre">Note:</span></code> text, this paragraph becomes a Sphinx <code class="docutils literal notranslate"><span class="pre">note::</span></code>
directive (this should be used to inform the end users of important
information related to that action/configuration)</p></li>
<li><p>if there is an <code class="docutils literal notranslate"><span class="pre">Example</span> <span class="pre">usage:</span></code> text, that paragraph becomes a Sphinx
<code class="docutils literal notranslate"><span class="pre">code-block::</span></code> with the example given.</p></li>
</ul>
<p>There are a few standards around YAML formatting that we closely follow in the
Slurm charms:</p>
<ul class="simple">
<li><p>wrap the lines at 80 columns</p></li>
<li><p>use multi-line strings</p></li>
</ul>
</section>
<section id="changelog">
<span id="id5"></span><h5>CHANGELOG<a class="headerlink" href="#changelog" title="Permalink to this heading">#</a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">CHANGELOG</span></code> file contains notable changes for end users, not charm
developers. This means that internal changes (e.g., code related to CI,
refactoring, unit tests, etc.) should not be documented.</p>
<p>Changes that should be documented include:</p>
<ul class="simple">
<li><p>bug fixes</p></li>
<li><p>new features</p></li>
<li><p>new components</p></li>
<li><p>changes in usage</p></li>
<li><p>breaking changes</p></li>
</ul>
<p>This file should be written in reStructuredText format and it is copied to the
documentation <a class="reference external" href="changelog.html">Changelog page</a> automatically.</p>
<p>There should always be one, and only one, section <code class="docutils literal notranslate"><span class="pre">Unreleased</span></code> in the
<code class="docutils literal notranslate"><span class="pre">CHANGELOG</span></code>. New entries should go at the top of this section.</p>
</section>
<section id="bats-tests">
<h5>Bats tests<a class="headerlink" href="#bats-tests" title="Permalink to this heading">#</a></h5>
<p>The Slurm Charms have an extensive suite of tests using
<a class="reference external" href="https://github.com/bats-core/bats-core/">Bats</a>.</p>
<p>To run the tests, you need two additional dependencies:
- <code class="docutils literal notranslate"><span class="pre">npm</span></code> and <code class="docutils literal notranslate"><span class="pre">npx</span></code> (<code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt</span> <span class="pre">install</span> <span class="pre">npm</span></code>)
- <code class="docutils literal notranslate"><span class="pre">juju-wait</span></code> (<code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">snap</span> <span class="pre">install</span> <span class="pre">juju-wait</span> <span class="pre">--classic</span></code>)</p>
<p>And then proceed to install Bats with <code class="docutils literal notranslate"><span class="pre">npm</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ npm install -g bats
</pre></div>
</div>
<p>To run all the tests, deploy the base bundle for OSD, then enter in the
directory of the <code class="docutils literal notranslate"><span class="pre">slurm-charms</span></code> and specify the name of the Juju model used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ JUJU_MODEL=default npx bats tests/
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will take a some minutes to run.</p>
</div>
<p>You can also run specific test-files manually:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ JUJU_MODEL=default npx bats tests/15-acct-gather.bats
</pre></div>
</div>
<p>Alternatively, the <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> contains a <code class="docutils literal notranslate"><span class="pre">tests</span></code> target that packs the
charms, deploys them, and run the tests. The test script creates two Juju
models on the active controller (be sure to be using a localhost LXD
controller), one for CentOS7 and one for Ubuntu Focal, deploys the charms, and
runs all the tests. This target does not remove these new models after the
tests finish and takes a considerable amount of time to run.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To run the <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">tests</span></code> target, you need a custom CentOS7 image on your
LXD installation. Please refer to <a class="reference internal" href="installation.html#centos7-image"><span class="std std-ref">CentOS7 Deploys on LXD clouds</span></a> for details on
building one.</p>
</div>
</section>
</section>
</section>
<section id="versioning">
<span id="id6"></span><h3>Versioning<a class="headerlink" href="#versioning" title="Permalink to this heading">#</a></h3>
<p>The Slurm-charms and <code class="docutils literal notranslate"><span class="pre">slurm-ops-manager</span></code> follow a semantic versioning scheme.</p>
</section>
<section id="release-process">
<span id="id7"></span><h3>Release process<a class="headerlink" href="#release-process" title="Permalink to this heading">#</a></h3>
<p>The release process is separated from the development process.
The development process includes writing code to add features and or
fixing issues. The release process involves building a new version of the
product and making it available to clients and end users.
Slurm-charms
^^^^^^^^^^^^</p>
<p>To make a new release of the Slurm-charms, use the <code class="docutils literal notranslate"><span class="pre">script/release.sh</span></code>
script. This script will update the <a class="reference internal" href="#changelog"><span class="std std-ref">CHANGELOG</span></a> with the version of the
new release, create a new commit with the changes, and create a new Git tag
with a description of the new release. This script intentionally does not push
to GitHub, this way one can review the changes before <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">slurm-charms</span></code> are always updated in the <code class="docutils literal notranslate"><span class="pre">latest/edge</span></code> channel in
CharmHub after every Pull Request is merged.</p>
<section id="id8">
<h4>Slurm-ops-manager<a class="headerlink" href="#id8" title="Permalink to this heading">#</a></h4>
<p>The release process for <code class="docutils literal notranslate"><span class="pre">slurm-ops-manager</span></code> is straightforward:</p>
<ul>
<li><p>bump the version string in the <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> file</p></li>
<li><p>create a new annotated Git tag: <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">tag</span> <span class="pre">--annotate</span> <span class="pre">--sign</span> <span class="pre">x.y.z</span></code>. The tag
name should be the new version of the library, as explained in
<a class="reference internal" href="#versioning"><span class="std std-ref">Versioning</span></a>.</p></li>
<li><p>the tag message should contain a summary of the changes for that release. For
example:</p>
<blockquote>
<div><p>Release 0.7.1</p>
<ul class="simple">
<li><p>use Omnivector's repository for rpm installation</p></li>
</ul>
</div></blockquote>
</li>
<li><p>push to GitHub: <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">--tags</span></code>.</p></li>
</ul>
</section>
</section>
</section>
</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="configuration/slurmrestd.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">slurmrestd</p>
      </div>
    </a>
    <a class="right-next"
       href="acknowledgments.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Acknowledgments</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#feedback">Feedback</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#documentation">Documentation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#git-branches">Git branches</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general-recommendations">General Recommendations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sections">Sections</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#naming-conventions">Naming conventions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#code">Code</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#git-usage">Git usage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#charm-development">Charm development</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#local-setup">Local setup</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#slurm-ops-manager">Slurm-ops-manager</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Slurm-charms</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#actions-and-configurations">Actions and Configurations</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#changelog">CHANGELOG</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#bats-tests">Bats tests</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#versioning">Versioning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#release-process">Release process</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Slurm-ops-manager</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Omnivector Solutions
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2021-2023, Omnivector Solutions.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>